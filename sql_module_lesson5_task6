Представим, что вы планируете снять жилье в Берлине на 7 дней, используя более хитрые фильтры, чем предлагаются на сайте.

В этой задаче можно потренироваться в написании подзапросов, но задание можно решить и без них.

Отберите объявления из таблицы listings, которые:

находятся на расстоянии от центра меньше среднего (здесь нам пригодится запрос из предыдущего задания)
обойдутся дешевле 100$ в день (price с учетом cleaning_fee, который добавляется к общей сумме за неделю, т.е его нужно делить на кол-во дней)
имеют последние отзывы (last_review), начиная с 1 сентября 2018 года
имеют WiFi в списке удобств (amenities)
Отсортируйте полученные значения по убыванию review_scores_rating (не забудьте перевести строку к численному виду) и в качестве ответа укажите host_id из первой строки. 

Hint: документация по функции multiSearchAnyCaseInsensitive(колонка, ['искомая_подстрока']), которая ищет заданную подстроку в строке вне зависимости от регистра и выдает 0 в случае, если подстрока не была найдена

SELECT
    id,
    toFloat64OrNull(review_scores_rating) as review_scores_rating,
    geoDistance(13.4050, 52.5200, toFloat64OrNull(longitude), toFloat64OrNull(latitude)) as geo,
    host_id,
    ((toFloat32OrNull(replaceRegexpAll(price, '[$,]', '')))+ ((toFloat32OrNull(replaceRegexpAll(cleaning_fee, '[$,]', '')))/7)) as price_for_day,
   toDateOrNull(last_review) as last_review,
    amenities
FROM
    listings
WHERE
    geo < (SELECT avg(geoDistance(13.4050, 52.5200, toFloat64OrNull(longitude), toFloat64OrNull(latitude))) 
    FROM listings) 
    and
    (toFloat32OrNull(replaceRegexpAll(price, '[$,]', ''))) < 100
    and
    last_review >= '2018-09-01'
    and
    multiSearchAnyCaseInsensitive(amenities, ['WiFi']) != 0
order by review_scores_rating desc
limit 10
